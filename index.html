<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LiftFlow Analytics</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gray: {
                            850: '#1f2937',
                            900: '#111827',
                            950: '#030712',
                        },
                        teal: {
                            400: '#2dd4bf',
                            500: '#14b8a6',
                            600: '#0d9488',
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #111827; }
        ::-webkit-scrollbar-thumb { background: #374151; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #4b5563; }
        
        .glass-panel {
            background: rgba(31, 41, 55, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .chart-bar-anim { animation: growUp 1s ease-out forwards; transform-origin: bottom; transform: scaleY(0); }
        @keyframes growUp { to { transform: scaleY(1); } }
        
        .chart-line-anim { stroke-dasharray: 1000; stroke-dashoffset: 1000; animation: drawLine 2s ease-out forwards; }
        @keyframes drawLine { to { stroke-dashoffset: 0; } }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 h-screen flex overflow-hidden selection:bg-teal-500 selection:text-white">

    <!-- Mobile Overlay -->
    <div id="sidebarOverlay" onclick="toggleSidebar()" class="fixed inset-0 bg-black/80 z-40 hidden md:hidden transition-all duration-300"></div>

    <!-- Sidebar (Hidden by default in Landing Mode) -->
    <aside id="sidebar" class="hidden fixed inset-y-0 left-0 z-50 w-72 bg-gray-950 border-r border-gray-800 flex-shrink-0 flex flex-col transition-transform duration-300 transform -translate-x-full md:relative md:translate-x-0">
        <div class="h-20 flex items-center px-8 border-b border-gray-800 justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-lg bg-teal-500 flex items-center justify-center shadow-lg shadow-teal-500/20">
                    <i class="fa-solid fa-layer-group text-white text-xl"></i>
                </div>
                <div>
                    <span class="text-white text-xl font-black tracking-tight block leading-none">LIFTFLOW</span>
                    <span class="text-gray-500 text-xs font-bold tracking-widest uppercase">Analytics</span>
                </div>
            </div>
            <button onclick="toggleSidebar()" class="md:hidden text-gray-400 hover:text-white transition-colors">
                <i class="fa-solid fa-times text-xl"></i>
            </button>
        </div>
        
        <div class="flex-1 overflow-y-auto py-6 px-4 space-y-1 custom-scrollbar">
            <p class="px-4 text-xs font-bold text-gray-600 uppercase tracking-wider mb-4">Menu</p>
            <nav class="space-y-2">
                <a onclick="switchTab('overview')" id="nav-overview" class="group flex items-center px-4 py-3 text-gray-400 hover:bg-gray-900 hover:text-white rounded-lg transition-all duration-200 cursor-pointer bg-gray-900 text-white border-l-2 border-teal-500">
                    <i class="fa-solid fa-chart-simple w-6"></i>
                    <span class="font-semibold">Overview</span>
                </a>
                <a onclick="switchTab('analytics')" id="nav-analytics" class="group flex items-center px-4 py-3 text-gray-400 hover:bg-gray-900 hover:text-white rounded-lg transition-all duration-200 cursor-pointer">
                    <i class="fa-solid fa-chart-pie w-6"></i>
                    <span class="font-semibold">Analytics</span>
                </a>
                
                <p class="px-4 text-xs font-bold text-gray-600 uppercase tracking-wider mt-8 mb-4">Library</p>
                <a onclick="switchTab('muscles')" id="nav-muscles" class="group flex items-center px-4 py-3 text-gray-400 hover:bg-gray-900 hover:text-white rounded-lg transition-all duration-200 cursor-pointer">
                    <i class="fa-solid fa-dumbbell w-6"></i>
                    <span class="font-semibold">Muscles</span>
                </a>
                <a onclick="switchTab('exercises')" id="nav-exercises" class="group flex items-center px-4 py-3 text-gray-400 hover:bg-gray-900 hover:text-white rounded-lg transition-all duration-200 cursor-pointer">
                    <i class="fa-solid fa-list w-6"></i>
                    <span class="font-semibold">Exercises</span>
                </a>
                
                <p class="px-4 text-xs font-bold text-gray-600 uppercase tracking-wider mt-8 mb-4">You</p>
                <a onclick="switchTab('records')" id="nav-records" class="group flex items-center px-4 py-3 text-gray-400 hover:bg-gray-900 hover:text-white rounded-lg transition-all duration-200 cursor-pointer">
                    <i class="fa-solid fa-trophy w-6"></i>
                    <span class="font-semibold">Records</span>
                </a>
                <a onclick="switchTab('history')" id="nav-history" class="group flex items-center px-4 py-3 text-gray-400 hover:bg-gray-900 hover:text-white rounded-lg transition-all duration-200 cursor-pointer">
                    <i class="fa-solid fa-clock-rotate-left w-6"></i>
                    <span class="font-semibold">History</span>
                </a>
                <a onclick="switchTab('diet')" id="nav-diet" class="group flex items-center px-4 py-3 text-gray-400 hover:bg-gray-900 hover:text-white rounded-lg transition-all duration-200 cursor-pointer">
                    <i class="fa-solid fa-utensils w-6"></i>
                    <span class="font-semibold">Nutrition</span>
                </a>
            </nav>
        </div>

        <div class="p-4 border-t border-gray-800 bg-gray-950">
            <div class="bg-gray-900 rounded-lg p-4 border border-gray-800">
                <input type="file" id="csvInputSidebar" accept=".csv" class="hidden" onchange="handleFileUpload(event)">
                <label for="csvInputSidebar" class="flex items-center justify-center w-full px-4 py-3 bg-teal-500 hover:bg-teal-400 text-white text-sm font-bold rounded cursor-pointer transition-all shadow-lg shadow-teal-500/20">
                    <i class="fa-solid fa-upload mr-2"></i> Import Data
                </label>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 flex flex-col overflow-hidden relative bg-gray-900">
        
        <!-- App Header (Visible only when Dashboard is active) -->
        <header id="appHeader" class="hidden h-20 bg-gray-950 border-b border-gray-800 flex items-center justify-between px-6 md:px-10 z-10">
            <div class="flex items-center">
                <button onclick="toggleSidebar()" class="md:hidden mr-4 text-gray-400 hover:text-white focus:outline-none transition-colors">
                    <i class="fa-solid fa-bars text-xl"></i>
                </button>
                <div>
                    <h2 class="text-2xl font-black text-white tracking-tight uppercase" id="pageTitle">Overview</h2>
                </div>
            </div>
            <div class="flex items-center gap-4">
                <div class="hidden md:flex items-center px-3 py-1.5 bg-gray-900 rounded border border-gray-800">
                    <div class="w-2 h-2 rounded-full bg-teal-500 mr-2"></div>
                    <span class="text-xs text-gray-400 font-mono" id="lastUpdate">SYNCED</span>
                </div>
            </div>
        </header>

        <!-- Scrollable Content -->
        <div class="flex-1 overflow-y-auto custom-scrollbar" id="mainContainer">
            
            <!-- Loading / Empty States -->
            <div id="loadingState" class="hidden flex flex-col items-center justify-center h-full min-h-screen">
                <div class="w-16 h-16 border-4 border-gray-800 border-t-teal-500 rounded-full animate-spin"></div>
                <p class="mt-6 text-gray-500 font-mono text-sm uppercase tracking-widest">Processing Workout Data...</p>
            </div>

            <!-- LANDING PAGE (Empty State) -->
            <div id="emptyState" class="min-h-full flex flex-col">
                
                <!-- Landing Header -->
                <nav class="flex items-center justify-between px-6 py-6 md:px-12 max-w-7xl mx-auto w-full">
                    <div class="flex items-center gap-2">
                        <div class="w-8 h-8 rounded bg-teal-500 flex items-center justify-center">
                            <i class="fa-solid fa-layer-group text-white text-sm"></i>
                        </div>
                        <span class="text-xl font-black tracking-tight text-white">LIFTFLOW</span>
                    </div>
                    <div class="hidden md:flex items-center gap-8 text-sm font-medium text-gray-400">
                        <a href="#features" class="hover:text-white transition-colors">Features</a>
                        <a href="#dashboard-preview" class="hover:text-white transition-colors">Dashboard</a>
                        <a href="#" class="hover:text-white transition-colors">Pricing</a>
                    </div>
                    <button onclick="document.getElementById('csvInput').click()" class="px-5 py-2 bg-gray-800 hover:bg-gray-700 text-white text-sm font-bold rounded-full border border-gray-700 transition-all">
                        Sign In
                    </button>
                </nav>

                <!-- Hero Section -->
                <section class="flex-1 flex flex-col items-center justify-center text-center px-6 py-20 md:py-32 max-w-5xl mx-auto">
                    <div class="inline-flex items-center px-3 py-1 rounded-full bg-teal-500/10 border border-teal-500/20 text-teal-400 text-xs font-bold uppercase tracking-wider mb-8">
                        <span class="w-2 h-2 rounded-full bg-teal-500 mr-2 animate-pulse"></span>
                        v2.0 Now Available
                    </div>
                    <h1 class="text-5xl md:text-7xl font-black text-white tracking-tight mb-6 leading-tight">
                        Visualize Your Gains.<br>
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-teal-400 to-teal-600">Decode Your Data.</span>
                    </h1>
                    <p class="text-lg md:text-xl text-gray-400 max-w-2xl mb-10 leading-relaxed">
                        Upload your workout CSVs to instantly track total volume, identify personal records (PRs), and optimize your routine for maximum strength and growth.
                    </p>
                    
                    <div class="flex flex-col sm:flex-row gap-4 w-full sm:w-auto">
                        <input type="file" id="csvInput" accept=".csv" class="hidden" onchange="handleFileUpload(event)">
                        <label for="csvInput" class="px-8 py-4 bg-teal-500 hover:bg-teal-400 text-white rounded-lg font-bold text-lg transition-all shadow-lg shadow-teal-500/25 cursor-pointer flex items-center justify-center">
                            <i class="fa-solid fa-upload mr-2"></i> Upload Hevy CSV
                        </label>
                        <button onclick="loadDemoData()" class="px-8 py-4 bg-gray-800 hover:bg-gray-700 text-white border border-gray-700 rounded-lg font-bold text-lg transition-all flex items-center justify-center">
                            <i class="fa-solid fa-chart-simple mr-2"></i> View Demo
                        </button>
                    </div>
                </section>

                <!-- Features Section -->
                <section id="features" class="px-6 py-20 bg-gray-950/50 border-y border-gray-800">
                    <div class="max-w-7xl mx-auto">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                            <!-- Feature 1 -->
                            <div class="p-8 rounded-2xl bg-gray-900 border border-gray-800 hover:border-teal-500/50 transition-all group">
                                <div class="w-12 h-12 rounded-lg bg-gray-800 flex items-center justify-center mb-6 group-hover:bg-teal-500/20 transition-colors">
                                    <i class="fa-solid fa-dumbbell text-teal-500 text-xl"></i>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-3">Automated Volume</h3>
                                <p class="text-gray-400 leading-relaxed">Instantly calculate total tonnage lifted per session and break it down by muscle group to ensure balanced training.</p>
                            </div>
                            <!-- Feature 2 -->
                            <div class="p-8 rounded-2xl bg-gray-900 border border-gray-800 hover:border-teal-500/50 transition-all group">
                                <div class="w-12 h-12 rounded-lg bg-gray-800 flex items-center justify-center mb-6 group-hover:bg-teal-500/20 transition-colors">
                                    <i class="fa-solid fa-trophy text-teal-500 text-xl"></i>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-3">PR Tracking</h3>
                                <p class="text-gray-400 leading-relaxed">Automatic identification of Personal Records across all exercises with historical timeline visualization.</p>
                            </div>
                            <!-- Feature 3 -->
                            <div class="p-8 rounded-2xl bg-gray-900 border border-gray-800 hover:border-teal-500/50 transition-all group">
                                <div class="w-12 h-12 rounded-lg bg-gray-800 flex items-center justify-center mb-6 group-hover:bg-teal-500/20 transition-colors">
                                    <i class="fa-solid fa-fire text-teal-500 text-xl"></i>
                                </div>
                                <h3 class="text-xl font-bold text-white mb-3">Consistency Heatmap</h3>
                                <p class="text-gray-400 leading-relaxed">Visualize your workout frequency with a GitHub-style contribution graph to maintain your streak.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Mock Dashboard Section -->
                <section id="dashboard-preview" class="px-6 py-20 max-w-7xl mx-auto w-full">
                    <div class="text-center mb-16">
                        <h2 class="text-3xl md:text-4xl font-black text-white mb-4">Performance Analytics Dashboard</h2>
                        <p class="text-gray-400">Deep dive into your training metrics with professional-grade visualization.</p>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Mock KPI Card -->
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6 shadow-xl">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <p class="text-xs font-bold text-gray-500 uppercase tracking-wider">Lifetime Volume</p>
                                    <p class="text-3xl font-black text-white mt-1">482,500 <span class="text-sm text-gray-500 font-normal">kg</span></p>
                                </div>
                                <div class="px-2 py-1 rounded bg-teal-500/10 text-teal-400 text-xs font-bold">+12%</div>
                            </div>
                            <div class="h-2 bg-gray-800 rounded-full overflow-hidden">
                                <div class="h-full bg-teal-500 w-3/4 rounded-full"></div>
                            </div>
                            <div class="mt-4 flex justify-between text-xs text-gray-500">
                                <span>Total PRs: <span class="text-white font-bold">42</span></span>
                                <span>Avg Duration: <span class="text-white font-bold">65m</span></span>
                            </div>
                        </div>

                        <!-- Mock Line Chart (SVG) -->
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6 shadow-xl lg:col-span-2">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="font-bold text-white text-sm uppercase tracking-wider">Total Lifting Volume (Last 12 Weeks)</h3>
                                <i class="fa-solid fa-ellipsis text-gray-600"></i>
                            </div>
                            <div class="h-40 w-full relative flex items-end justify-between gap-2 px-2">
                                <!-- SVG Line -->
                                <svg class="absolute inset-0 w-full h-full overflow-visible" preserveAspectRatio="none">
                                    <path d="M0,100 C50,80 100,120 150,60 S250,40 300,80 S400,20 500,40 S600,10 700,30" 
                                          fill="none" stroke="#14b8a6" stroke-width="3" class="chart-line-anim" vector-effect="non-scaling-stroke"/>
                                    <path d="M0,100 C50,80 100,120 150,60 S250,40 300,80 S400,20 500,40 S600,10 700,30 V160 H0 Z" 
                                          fill="url(#gradient)" opacity="0.2" />
                                    <defs>
                                        <linearGradient id="gradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                            <stop offset="0%" style="stop-color:#14b8a6;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#14b8a6;stop-opacity:0" />
                                        </linearGradient>
                                    </defs>
                                </svg>
                                <!-- Grid Lines -->
                                <div class="absolute inset-0 flex flex-col justify-between pointer-events-none">
                                    <div class="w-full h-px bg-gray-800"></div>
                                    <div class="w-full h-px bg-gray-800"></div>
                                    <div class="w-full h-px bg-gray-800"></div>
                                    <div class="w-full h-px bg-gray-800"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Mock Bar Chart (SVG) -->
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6 shadow-xl lg:col-span-2">
                            <h3 class="font-bold text-white text-sm uppercase tracking-wider mb-6">Monthly Workout Frequency</h3>
                            <div class="h-40 flex items-end justify-between gap-3">
                                <div class="w-full bg-teal-500/20 rounded-t hover:bg-teal-500 transition-colors h-[40%] chart-bar-anim" style="animation-delay: 0.1s"></div>
                                <div class="w-full bg-teal-500/20 rounded-t hover:bg-teal-500 transition-colors h-[60%] chart-bar-anim" style="animation-delay: 0.2s"></div>
                                <div class="w-full bg-teal-500/20 rounded-t hover:bg-teal-500 transition-colors h-[30%] chart-bar-anim" style="animation-delay: 0.3s"></div>
                                <div class="w-full bg-teal-500/20 rounded-t hover:bg-teal-500 transition-colors h-[80%] chart-bar-anim" style="animation-delay: 0.4s"></div>
                                <div class="w-full bg-teal-500/20 rounded-t hover:bg-teal-500 transition-colors h-[50%] chart-bar-anim" style="animation-delay: 0.5s"></div>
                                <div class="w-full bg-teal-500/20 rounded-t hover:bg-teal-500 transition-colors h-[75%] chart-bar-anim" style="animation-delay: 0.6s"></div>
                                <div class="w-full bg-teal-500 rounded-t shadow-[0_0_15px_rgba(20,184,166,0.5)] h-[90%] chart-bar-anim" style="animation-delay: 0.7s"></div>
                            </div>
                            <div class="flex justify-between mt-2 text-xs text-gray-500 font-mono">
                                <span>JAN</span><span>FEB</span><span>MAR</span><span>APR</span><span>MAY</span><span>JUN</span><span>JUL</span>
                            </div>
                        </div>

                        <!-- Mock 1RM Progress -->
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6 shadow-xl">
                            <h3 class="font-bold text-white text-sm uppercase tracking-wider mb-6">1RM Progress</h3>
                            <div class="space-y-4">
                                <div>
                                    <div class="flex justify-between text-xs mb-1">
                                        <span class="text-gray-400">Squat</span>
                                        <span class="text-white font-bold">140 kg</span>
                                    </div>
                                    <div class="h-2 bg-gray-800 rounded-full">
                                        <div class="h-full bg-teal-500 w-[85%] rounded-full"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-xs mb-1">
                                        <span class="text-gray-400">Bench</span>
                                        <span class="text-white font-bold">100 kg</span>
                                    </div>
                                    <div class="h-2 bg-gray-800 rounded-full">
                                        <div class="h-full bg-white w-[60%] rounded-full"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between text-xs mb-1">
                                        <span class="text-gray-400">Deadlift</span>
                                        <span class="text-white font-bold">180 kg</span>
                                    </div>
                                    <div class="h-2 bg-gray-800 rounded-full">
                                        <div class="h-full bg-gray-600 w-[95%] rounded-full"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Footer -->
                <footer class="py-8 text-center text-gray-600 text-sm border-t border-gray-800 mt-auto">
                    <p>&copy; 2025 LiftFlow Analytics. All rights reserved.</p>
                </footer>
            </div>

            <!-- Content Views -->
            <div id="contentArea" class="hidden space-y-8 animate-fade-in">
                
                <!-- VIEW: OVERVIEW -->
                <div id="view-overview" class="space-y-6">
                    <!-- Top Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <div class="bg-gray-900 rounded-xl p-6 border border-gray-800">
                            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider">Total Workouts</p>
                            <p class="text-4xl font-black text-white mt-2 italic" id="kpi-workouts">-</p>
                        </div>
                        <div class="bg-gray-900 rounded-xl p-6 border border-gray-800">
                            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider">Total Volume</p>
                            <p class="text-4xl font-black text-white mt-2 italic" id="kpi-volume">-</p>
                        </div>
                        <div class="bg-gray-900 rounded-xl p-6 border border-gray-800">
                            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider">Total Sets</p>
                            <p class="text-4xl font-black text-white mt-2 italic" id="kpi-sets">-</p>
                        </div>
                        <div class="bg-gray-900 rounded-xl p-6 border border-gray-800">
                            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider">Active Days</p>
                            <p class="text-4xl font-black text-white mt-2 italic" id="kpi-days">-</p>
                        </div>
                    </div>

                    <!-- Charts Row 1 -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6 lg:col-span-2">
                            <h3 class="font-bold text-white mb-6 flex items-center uppercase tracking-wider text-sm">Volume Progression</h3>
                            <div class="h-72">
                                <canvas id="volumeChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 flex items-center uppercase tracking-wider text-sm">Consistency</h3>
                            <div class="h-72">
                                <canvas id="consistencyChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Row 2 -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Muscle Split</h3>
                            <div class="h-72">
                                <canvas id="muscleSplitChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Intensity (RPE)</h3>
                            <div class="h-72">
                                <canvas id="intensityChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Heatmap -->
                    <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                        <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Activity Heatmap</h3>
                        <div class="overflow-x-auto pb-2 custom-scrollbar">
                            <div id="heatmapContainer" class="min-w-[800px]"></div>
                        </div>
                    </div>
                </div>

                <!-- VIEW: ANALYTICS -->
                <div id="view-analytics" class="hidden space-y-6">
                    <!-- Comparison Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Monthly Comparison -->
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 flex items-center uppercase tracking-wider text-sm">
                                Monthly Comparison
                                <span class="ml-auto text-xs font-bold text-gray-500 bg-gray-950 px-2 py-1 rounded" id="analytics-month-label">This Month vs Last</span>
                            </h3>
                            <div class="grid grid-cols-3 gap-4">
                                <div class="text-center p-4 bg-gray-950 rounded-lg border border-gray-800">
                                    <div class="text-xs text-gray-500 mb-1 uppercase tracking-wider">Workouts</div>
                                    <div class="font-black text-white text-xl italic" id="comp-month-workouts">-</div>
                                    <div class="text-xs mt-1 font-bold" id="diff-month-workouts">-</div>
                                </div>
                                <div class="text-center p-4 bg-gray-950 rounded-lg border border-gray-800">
                                    <div class="text-xs text-gray-500 mb-1 uppercase tracking-wider">Volume</div>
                                    <div class="font-black text-white text-xl italic" id="comp-month-volume">-</div>
                                    <div class="text-xs mt-1 font-bold" id="diff-month-volume">-</div>
                                </div>
                                <div class="text-center p-4 bg-gray-950 rounded-lg border border-gray-800">
                                    <div class="text-xs text-gray-500 mb-1 uppercase tracking-wider">Sets</div>
                                    <div class="font-black text-white text-xl italic" id="comp-month-sets">-</div>
                                    <div class="text-xs mt-1 font-bold" id="diff-month-sets">-</div>
                                </div>
                            </div>
                        </div>

                        <!-- Weekly Comparison -->
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 flex items-center uppercase tracking-wider text-sm">
                                Weekly Comparison
                                <span class="ml-auto text-xs font-bold text-gray-500 bg-gray-950 px-2 py-1 rounded" id="analytics-week-label">This Week vs Last</span>
                            </h3>
                            <div class="grid grid-cols-3 gap-4">
                                <div class="text-center p-4 bg-gray-950 rounded-lg border border-gray-800">
                                    <div class="text-xs text-gray-500 mb-1 uppercase tracking-wider">Workouts</div>
                                    <div class="font-black text-white text-xl italic" id="comp-week-workouts">-</div>
                                    <div class="text-xs mt-1 font-bold" id="diff-week-workouts">-</div>
                                </div>
                                <div class="text-center p-4 bg-gray-950 rounded-lg border border-gray-800">
                                    <div class="text-xs text-gray-500 mb-1 uppercase tracking-wider">Volume</div>
                                    <div class="font-black text-white text-xl italic" id="comp-week-volume">-</div>
                                    <div class="text-xs mt-1 font-bold" id="diff-week-volume">-</div>
                                </div>
                                <div class="text-center p-4 bg-gray-950 rounded-lg border border-gray-800">
                                    <div class="text-xs text-gray-500 mb-1 uppercase tracking-wider">Sets</div>
                                    <div class="font-black text-white text-xl italic" id="comp-week-sets">-</div>
                                    <div class="text-xs mt-1 font-bold" id="diff-week-sets">-</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Session Trends -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Avg Volume per Session</h3>
                            <div class="h-64">
                                <canvas id="sessionVolumeChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Avg Duration per Session</h3>
                            <div class="h-64">
                                <canvas id="sessionDurationChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Day of Week Analysis -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Preferred Training Days</h3>
                            <div class="h-64">
                                <canvas id="dayOfWeekChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Avg Volume per Day</h3>
                            <div class="h-64">
                                <canvas id="dayOfWeekVolumeChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Volume Analysis -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Avg Volume per Muscle Group</h3>
                            <div class="h-64">
                                <canvas id="avgMuscleVolumeChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Avg Volume per Month</h3>
                            <div class="h-64">
                                <canvas id="avgMonthlyVolumeChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Weekly Volume Progress -->
                    <div class="bg-gray-900 rounded-xl border border-gray-800 p-6 mt-6">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="font-bold text-white uppercase tracking-wider text-sm">Avg Volume per Week</h3>
                            <div class="text-right bg-gray-950 px-4 py-2 rounded border border-gray-800">
                                <p class="text-xs text-gray-500 uppercase tracking-wider">Avg Session Vol</p>
                                <p class="text-xl font-black text-teal-400 italic" id="avgWeeklyVolumeDisplay">-</p>
                            </div>
                        </div>
                        <div class="h-64">
                            <canvas id="weeklyVolumeProgressChart"></canvas>
                        </div>
                    </div>

                    <!-- Advanced Performance Metrics -->
                    <div class="flex items-center gap-4 mt-10 mb-6">
                        <div class="h-px bg-gray-800 flex-1"></div>
                        <h3 class="text-lg font-black text-white uppercase tracking-widest italic">Advanced Metrics</h3>
                        <div class="h-px bg-gray-800 flex-1"></div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Big 3 Strength Progression -->
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">"Big 3" Strength Progression</h3>
                            <div class="h-72">
                                <canvas id="strengthProgressionChart"></canvas>
                            </div>
                        </div>

                        <!-- Training Signature Radar -->
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Monthly Training Signature</h3>
                            <div class="h-72 flex items-center justify-center">
                                <canvas id="trainingSignatureChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Training Style & Efficiency Section -->
                    <div class="flex items-center gap-4 mt-10 mb-6">
                        <div class="h-px bg-gray-800 flex-1"></div>
                        <h3 class="text-lg font-black text-white uppercase tracking-widest italic">Training Style</h3>
                        <div class="h-px bg-gray-800 flex-1"></div>
                    </div>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <!-- Rep Ranges -->
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 text-center uppercase tracking-wider text-sm">Rep Range Analysis</h3>
                            <div class="h-64 flex items-center justify-center">
                                <canvas id="repRangeChart"></canvas>
                            </div>
                        </div>

                        <!-- Set Types -->
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 text-center uppercase tracking-wider text-sm">Set Type Distribution</h3>
                            <div class="h-64 flex items-center justify-center">
                                <canvas id="setTypeChart"></canvas>
                            </div>
                        </div>

                        <!-- Workout Density -->
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 text-center uppercase tracking-wider text-sm">Workout Density</h3>
                            <div class="h-64">
                                <canvas id="densityChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VIEW: MUSCLES -->
                <div id="view-muscles" class="hidden space-y-6">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Muscle Balance</h3>
                            <div class="h-80 flex items-center justify-center">
                                <canvas id="muscleRadarChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Sets Distribution</h3>
                            <div class="h-80 flex items-center justify-center">
                                <canvas id="musclePieChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                        <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Detailed Muscle Breakdown</h3>
                        <div class="overflow-x-auto custom-scrollbar">
                            <table class="min-w-full divide-y divide-gray-800">
                                <thead class="bg-gray-950">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Muscle Group</th>
                                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Total Sets</th>
                                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Total Volume</th>
                                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Freq</th>
                                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">%</th>
                                    </tr>
                                </thead>
                                <tbody id="muscleTableBody" class="divide-y divide-gray-800">
                                    <!-- JS Populated -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- VIEW: EXERCISES -->
                <div id="view-exercises" class="hidden space-y-6">
                    <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                        <div class="flex flex-col sm:flex-row justify-between items-center mb-6 gap-4">
                            <h3 class="font-bold text-white uppercase tracking-wider text-sm">Exercise Library</h3>
                            <div class="relative">
                                <input type="text" id="exerciseSearch" placeholder="Search..." class="pl-10 pr-4 py-2 bg-gray-950 border border-gray-800 rounded-lg focus:ring-1 focus:ring-teal-400 focus:border-teal-400 w-64 text-white placeholder-gray-600 transition-all">
                                <i class="fa-solid fa-search absolute left-3 top-3 text-gray-600"></i>
                            </div>
                        </div>
                        <div class="overflow-x-auto custom-scrollbar">
                            <table class="min-w-full divide-y divide-gray-800">
                                <thead class="bg-gray-950">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer hover:text-white transition-colors" onclick="sortExercises('name')">Exercise</th>
                                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer hover:text-white transition-colors" onclick="sortExercises('muscle')">Muscle</th>
                                        <th class="px-6 py-4 text-right text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer hover:text-white transition-colors" onclick="sortExercises('sets')">Sets</th>
                                        <th class="px-6 py-4 text-right text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer hover:text-white transition-colors" onclick="sortExercises('max')">Max</th>
                                        <th class="px-6 py-4 text-right text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer hover:text-white transition-colors" onclick="sortExercises('1rm')">1RM</th>
                                        <th class="px-6 py-4 text-right text-xs font-bold text-gray-500 uppercase tracking-wider">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="exerciseTableBody" class="divide-y divide-gray-800">
                                    <!-- JS Populated -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- VIEW: RECORDS -->
                <div id="view-records" class="hidden space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6" id="recordsContainer">
                        <!-- JS Populated -->
                    </div>
                </div>

                <!-- VIEW: HISTORY -->
                <div id="view-history" class="hidden space-y-6">
                    <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                        <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Workout Log</h3>
                        <div class="overflow-x-auto custom-scrollbar">
                            <table class="min-w-full divide-y divide-gray-800">
                                <thead class="bg-gray-950">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Date</th>
                                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Title</th>
                                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Duration</th>
                                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Volume</th>
                                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Sets</th>
                                        <th class="px-6 py-4 text-left text-xs font-bold text-gray-500 uppercase tracking-wider">Exercises</th>
                                    </tr>
                                </thead>
                                <tbody id="historyTableBody" class="divide-y divide-gray-800">
                                    <!-- JS Populated -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- VIEW: DIET -->
                <div id="view-diet" class="hidden space-y-6">
                    <!-- Today's Tracker -->
                    <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                        <div class="flex justify-between items-center mb-8">
                            <div>
                                <h3 class="text-2xl font-black text-white italic uppercase">Today's Fuel</h3>
                                <p class="text-sm text-gray-500 mt-1" id="diet-date-display">Loading...</p>
                            </div>
                            <div class="text-right bg-gray-950 px-5 py-3 rounded-lg border border-gray-800">
                                <div class="text-3xl font-black text-teal-400 italic" id="diet-today-score">0/10</div>
                                <div class="text-xs text-gray-500 uppercase tracking-wider">Daily Score</div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4" id="diet-checklist">
                            <!-- JS Populated -->
                        </div>

                        <div class="mt-8 pt-6 border-t border-gray-800 flex justify-between items-center">
                            <div class="flex items-center">
                                <div class="w-12 h-12 rounded-full bg-gray-800 flex items-center justify-center text-white mr-4 border border-gray-700">
                                    <i class="fa-solid fa-drumstick-bite text-lg"></i>
                                </div>
                                <div>
                                    <p class="text-xs text-gray-500 uppercase tracking-wider">Protein Intake</p>
                                    <p class="font-black text-white text-xl italic"><span id="diet-today-protein">0</span>g</p>
                                </div>
                            </div>
                            <div class="flex items-center">
                                <div class="w-12 h-12 rounded-full bg-gray-800 flex items-center justify-center text-white mr-4 border border-gray-700">
                                    <i class="fa-solid fa-check text-lg"></i>
                                </div>
                                <div>
                                    <p class="text-xs text-gray-500 uppercase tracking-wider">Completion</p>
                                    <p class="font-black text-white text-xl italic"><span id="diet-today-percent">0</span>%</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Diet Analytics -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Diet Score History</h3>
                            <div class="h-64">
                                <canvas id="dietScoreChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <h3 class="font-bold text-white mb-6 uppercase tracking-wider text-sm">Protein Intake History</h3>
                            <div class="h-64">
                                <canvas id="dietProteinChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Weekly/Monthly Stats -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- Scores -->
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-2">Avg Score (Week)</p>
                            <p class="text-3xl font-black text-white italic" id="diet-avg-week">-</p>
                        </div>
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-2">Avg Score (Month)</p>
                            <p class="text-3xl font-black text-white italic" id="diet-avg-month">-</p>
                        </div>
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-2">Avg Score (All Time)</p>
                            <p class="text-3xl font-black text-white italic" id="diet-avg-all">-</p>
                        </div>
                        
                        <!-- Protein -->
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-2">Avg Protein (Week)</p>
                            <p class="text-3xl font-black text-teal-400 italic" id="diet-avg-protein-week">-</p>
                        </div>
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-2">Avg Protein (Month)</p>
                            <p class="text-3xl font-black text-teal-400 italic" id="diet-avg-protein-month">-</p>
                        </div>
                        <div class="bg-gray-900 rounded-xl border border-gray-800 p-6">
                            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider mb-2">Avg Protein (All Time)</p>
                            <p class="text-3xl font-black text-teal-400 italic" id="diet-avg-protein-all">-</p>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <!-- Modal -->
    <div id="modalOverlay" class="fixed inset-0 bg-black/90 hidden z-50 flex items-center justify-center p-4 transition-opacity duration-300">
        <div class="bg-gray-900 rounded-xl shadow-2xl border border-gray-800 w-full max-w-4xl max-h-[90vh] flex flex-col transform transition-all scale-100">
            <div class="px-6 py-5 border-b border-gray-800 flex justify-between items-center bg-gray-900 rounded-t-xl">
                <h3 class="text-xl font-black text-white italic uppercase" id="modalTitle">Details</h3>
                <button onclick="closeModal()" class="text-gray-400 hover:text-white transition-colors">
                    <i class="fa-solid fa-times text-xl"></i>
                </button>
            </div>
            <div class="p-6 overflow-y-auto custom-scrollbar" id="modalContent">
                <!-- Dynamic Content -->
            </div>
        </div>
    </div>

    <style>
        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #475569; border-radius: 3px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #64748b; }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
    </style>

    <script src="app.js"></script>
</body>
</html>